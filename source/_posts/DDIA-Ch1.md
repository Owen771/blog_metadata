---
title: DDIA Ch1
date: 2024-07-05 12:20:24
tags:
---
# Ch1 

- Nowsaday most of the app is data-intensive instead of compute-intensive

DDIA 著重討論三個在大多數軟體系統中都很重要的問題：

1. 可靠性（Reliability）
- 系統在 困境（adversity，比如硬體故障、軟體故障、人為錯誤）中仍可正常工作（正確完成功能，並能達到期望的效能水準）

2. 可伸縮性（Scalability）
- 有合理的辦法應對系統的增長（資料量、流量、複雜性)

1. 可維護性（Maintainability）
- 許多不同的人（工程師、運維）在不同的生命週期，都能高效地在系統上工作（使系統保持現有行為，並適應新的應用場景）

## Challenge:
- 資料量
- 資料複雜性
- 資料的變更速度

## System component 
- Database
- Cache (Redis, Memcached)
- MQ

---
## Aspect
- Search index
  - 全文搜尋 Elasticsearch 或 Solr
- Stream processing
- Batch processing


## Problem introduced when system get complex

- 快取 / 索引與主資料庫保持同步
- 當系統出問題時，如何確保資料的正確性和完整性？
- 當部分系統退化降級時，如何為客戶提供始終如一的良好效能？
- 當負載增加時，如何擴容應對？
- 什麼樣的 API 才是好的 API？


--- 

- System should be 可靠、可伸縮、可維護
- 當你將多個工具組合在一起提供服務時，API 向客戶端隱藏這些實現細節

--- 

# 可靠性

-  可以把可靠性粗略理解為 “即使出現問題，也能繼續正確工作”。

- 造成錯誤的原因叫做 故障（fault），能預料並應對故障的系統特性可稱為 容錯（fault-tolerant） 或 回彈性（resilient）。“容錯” 一詞可能會產生誤導，因為它暗示著系統可以容忍所有可能的錯誤，但在實際中這是不可能的。 


- 故障（fault） 不同於 失效（failure）【2】。故障 通常定義為系統的一部分狀態偏離其標準，而 失效 則是系統作為一個整體停止向用戶提供服務。 
- 故障的機率不可能降到零，因此最好設計容錯機制以防因 故障 而導致 失效 

## 硬體故障
 
- must have
- sol: 增加單個硬體的冗餘度 
  - 伺服器可能有雙路電源和熱插拔 CPU，
  - 資料中心可能有電池和柴油發電機作為後備電源，
  - 某個元件掛掉時冗餘元件可以立刻接管。

- 只有少量高可用性至關重要的應用才會要求有多套硬體冗餘。
  - normally 1 套硬體冗餘 is enough

- 如果在硬體冗餘的基礎上進一步引入軟體容錯機制，那麼系統在容忍整個（單臺）機器故障的道路上就更進一步了。這樣的系統也有運維上的便利，例如：如果需要重啟機器（例如應用作業系統安全補丁），單伺服器系統就需要計劃停機。而允許機器失效的系統則可以一次修復一個節點，無需整個系統停機。

## 軟體錯誤

- 我們通常認為硬體故障是隨機的、相互獨立的：一臺機器的磁碟失效並不意味著另一臺機器的磁碟也會失效。雖然大量硬體元件之間可能存在微弱的相關性（例如伺服器機架的溫度等共同的原因），但同時發生故障也是極為罕見的。
- but software error is related, one down, others most likely will down too


- 雖然軟體中的系統性故障沒有速效藥，但我們還是有很多小辦法，例如：仔細考慮系統中的假設和互動；徹底的測試；程序隔離；允許程序崩潰並重啟；測量、監控並分析生產環境中的系統行為。如果系統能夠提供一些保證（例如在一個訊息佇列中，進入與發出的訊息數量相等），那麼系統就可以在執行時不斷自檢，並在出現 差異（discrepancy） 時報警。

# 可伸縮性（Scalability） 

- 是用來描述系統應對負載增長能力的術語
- 服務降級（degradation） 的一個常見原因是負載增加，例如：系統負載已經從一萬個併發使用者增長到十萬個併發使用者, 現在處理的資料量級要比過去大得多。

- 但是請注意，這不是貼在系統上的一維標籤：說 “X 可伸縮” 或 “Y 不可伸縮” 是沒有任何意義的。相反，討論可伸縮性意味著考慮諸如 “如果系統以特定方式增長，有什麼選項可以應對增長？” 和 “如何增加計算資源來處理額外的負載？” 等問題。







# 可維護性

在設計之初就儘量考慮儘可能減少維護期間的痛苦，從而避免自己的軟體系統變成遺留系統。為此，我們將特別關注軟體系統的三個設計原則：

1. 可操作性（Operability）: 便於運維團隊保持系統平穩執行。

2. 簡單性（Simplicity）: 從系統中消除儘可能多的 複雜度（complexity），使新工程師也能輕鬆理解系統（注意這和使用者介面的簡單性不一樣）。

3. 可演化性（evolvability）: 使工程師在未來能輕鬆地對系統進行更改，當需求變化時為新應用場景做適配。也稱為 可擴充套件性（extensibility）、可修改性（modifiability） 或 可塑性（plasticity）。 





